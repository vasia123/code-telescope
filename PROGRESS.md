# План реализации проекта "Code Telescope"

## Общее описание
"Code Telescope" — инструмент на языке Go для генерации высокоуровневых карт кода проектов с использованием ЛЛМ. Инструмент анализирует исходные файлы проекта, извлекает их структуру (импорты, экспорты, публичные методы) и генерирует Markdown-документацию, представляющую каждый файл как "черный ящик" с описанием его интерфейсов.

## План реализации

### Этап 1: Настройка проекта
- [x] Создание структуры директорий проекта
- [x] Инициализация Go-модуля
- [x] Создание базового файла конфигурации
- [x] Настройка Makefile для сборки

### Этап 2: Модуль конфигурации
- [x] Реализация структуры конфигурации
- [x] Функции загрузки конфигурации из файла
- [x] Функции валидации конфигурации
- [x] Настройка параметров по умолчанию

### Этап 3: Модуль файловой системы
- [x] Реализация сканирования директорий
- [x] Фильтрация файлов на основе конфигурации
- [x] Сбор метаданных о файлах

### Этап 4: Модуль парсинга кода
- [x] Временная реализация без Tree-sitter
- [ ] Исправление несоответствий между интерфейсами и реализациями
- [ ] Доработка парсера Go для правильного анализа параметров и возвращаемых значений
- [ ] Обработка методов, принадлежащих типам
- [ ] Настройка Tree-sitter для более точного парсинга
- [ ] Реализация парсеров для других языков (JavaScript, Python)

### Этап 5: Модуль взаимодействия с ЛЛМ
- [x] Абстрактный интерфейс ЛЛМ
- [x] Реализация для OpenAI API
- [x] Реализация для Anthropic API
- [x] Создание конструктора промптов
- [ ] Доработка конструктора промптов для улучшения качества описаний

### Этап 6: Модуль генерации Markdown
- [x] Создание шаблонов для Markdown
- [x] Функции генерации разделов документации
- [x] Функции генерации полной карты кода
- [ ] Исправление преобразования между типами CodeStructure и FileStructure

### Этап 7: Оркестратор
- [x] Координация всего процесса (базовый каркас)
- [x] Полная интеграция со всеми модулями
- [x] Обработка ошибок
- [x] Логирование
- [ ] Исправление обработки методов в GenerateCodeMap
- [ ] Правильное преобразование CodeStructure в формат FileStructure

### Этап 8: CLI и документация
- [x] Реализация CLI-интерфейса
- [ ] Создание пользовательской документации
- [ ] Создание примеров использования

## Текущий статус и выявленные проблемы

### Проблемы в парсере и фабрике языков
1. Несоответствие между интерфейсами: в language_factory.go используется модель models.Parser, но нужна синхронизация с реальной реализацией.
2. Парсер Go использует слишком примитивный подход с поиском по строкам вместо синтаксического анализа.
3. В текущей реализации парсера Go не полностью извлекаются параметры и возвращаемые значения методов.
4. Отсутствуют парсеры для других языков.

### Проблемы в оркестраторе
1. В методе GenerateCodeMap есть несоответствие между CodeStructure и FileStructure.
2. Неправильная обработка методов из структуры кода для отправки в ЛЛМ.
3. Не реализована правильная группировка методов по типам.

## Следующие шаги
1. Исправить несоответствия между интерфейсами Parser в различных модулях.
2. Доработать парсер Go для правильного извлечения всех необходимых данных.
3. Реализовать правильное преобразование между CodeStructure и FileStructure.
4. Доработать оркестратор для правильной обработки и группировки методов.
5. Добавить поддержку дополнительных языков (JavaScript, Python).
6. Подготовить документацию по использованию и примеры.
7. Провести тестирование на реальных проектах разного размера.